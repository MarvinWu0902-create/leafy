import{l as f}from"./index-BxML_Rvc.js";import{a as o}from"./axios-Bo0ATomq.js";var p={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_PATH:"marvinapipath",BASE_URL:"/leafy/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:l,VITE_PATH:n}=p,c=()=>o.get(`${l}/api/${n}/cart`),C=(a,e=1)=>o.post(`${l}/api/${n}/cart`,{data:{product_id:a,qty:e}}),u=a=>o.delete(`${l}/api/${n}/cart/${a}`),g=()=>o.delete(`${l}/api/${n}/carts`),I=(a,e,t=1)=>o.put(`${l}/api/${n}/cart/${a}`,{data:{product_id:e,qty:t}}),_=f("cart",{state(){return{cartData:[],tempId:"",cartLoading:{getCart:!1,addCart:!1,delCart:!1,adjustCart:!1},iscartOpen:!1,resInfo:"",finaltotalPrice:0,totalPrice:0}},actions:{getCart(){this.cartLoading.getCart=!0,c().then(a=>{const{carts:e,final_total:t,total:r}=a.data.data;this.cartData=e,this.finaltotalPrice=t,this.totalPrice=r,this.cartLoading.getCart=!1}).catch(()=>{alert("取得購物車資料失敗")})},addCart(a,e){this.tempId=a,this.cartLoading.addCart=!0,C(a,e).then(t=>(this.resInfo=t.data,c())).then(t=>{const{carts:r,final_total:i,total:s}=t.data.data;this.cartData=r,this.finaltotalPrice=i,this.totalPrice=s,this.cartLoading.addCart=!1,this.tempId=""}).catch(()=>{alert("品項加入購物車失敗")})},deleteCart(a,e){this.cartLoading.delCart=!0,a==="all"?g().then(t=>(this.resInfo=t.data,c())).then(t=>{const{carts:r,final_total:i,total:s}=t.data.data;this.cartData=r,this.finaltotalPrice=i,this.totalPrice=s,this.cartLoading.delCart=!1}).catch(()=>{alert("刪除購物車全品項失敗")}):(this.tempId=e,u(e).then(t=>(this.resInfo=t.data,c())).then(t=>{const{carts:r,final_total:i,total:s}=t.data.data;this.cartData=r,this.finaltotalPrice=i,this.totalPrice=s,this.cartLoading.delCart=!1,this.tempId=""}).catch(()=>{alert("刪除購物車品項失敗")}))},adjustCart(a){const{id:e,product_id:t,qty:r}=a;this.cartLoading.adjustCart=!0,this.tempId=e,I(e,t,r).then(i=>(this.resInfo=i.data,c())).then(i=>{const{carts:s,final_total:d,total:h}=i.data.data;this.cartData=s,this.finaltotalPrice=d,this.totalPrice=h,this.cartLoading.adjustCart=!1,this.tempId=""}).catch(()=>{alert("調整購物車品項數量失敗")})},cartClick(){this.iscartOpen=!this.iscartOpen}}});export{_ as c};
